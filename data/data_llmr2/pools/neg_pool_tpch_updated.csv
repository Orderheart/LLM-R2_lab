,db_id,original_sql,rewritten_sql,activated_rules,original_logical_plan
0,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1619.s_acctbal, t1619.s_name, t1619.n_name, t1619.p_partkey, t1619.p_mfgr, t1619.s_address, t1619.s_phone, t1619.s_comment FROM (SELECT t1605.p_partkey, t1605.p_name, t1605.p_mfgr, t1605.p_brand, t1605.p_type, t1605.p_size, t1605.p_container, t1605.p_retailprice, t1605.p_comment, t1605.s_suppkey, t1605.s_name, t1605.s_address, t1605.s_nationkey, t1605.s_phone, t1605.s_acctbal, t1605.s_comment, t1605.ps_partkey, t1605.ps_suppkey, t1605.ps_availqty, t1605.ps_supplycost, t1605.ps_comment, t1605.n_nationkey, t1605.n_name, t1605.n_regionkey, t1605.n_comment, t1605.r_regionkey, t1605.r_name, t1605.r_comment, CAST(t1616.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1616.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 20 AND p_type LIKE '%COPPER') AS t1601, supplier AS supplier201, partsupp AS partsupp201 WHERE t1601.p_partkey = partsupp201.ps_partkey AND supplier201.s_suppkey = partsupp201.ps_suppkey) AS t1602, nation AS nation201 WHERE t1602.s_nationkey = nation201.n_nationkey) AS t1603, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1604 WHERE t1603.n_regionkey = t1604.r_regionkey) AS t1605, (SELECT t1612.ps_partkey, MIN(t1612.EXPR0) AS EXPR0 FROM (SELECT t1609.ps_partkey, t1610.n_regionkey, MIN(t1609.EXPR0) AS EXPR0 FROM (SELECT t1606.ps_partkey, t1607.s_nationkey, MIN(t1606.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1606, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1607 WHERE t1607.s_suppkey = t1606.ps_suppkey GROUP BY t1606.ps_partkey, t1607.s_nationkey) AS t1609, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1610 WHERE t1609.s_nationkey = t1610.n_nationkey GROUP BY t1609.ps_partkey, t1610.n_regionkey) AS t1612, (SELECT r_regionkey FROM region WHERE r_name = 'AMERICA' GROUP BY r_regionkey) AS t1614 WHERE t1612.n_regionkey = t1614.r_regionkey GROUP BY t1612.ps_partkey) AS t1616 WHERE t1605.p_partkey = t1616.ps_partkey AND t1605.ps_supplycost = t1616.EXPR0 ORDER BY t1605.s_acctbal DESC, t1605.n_name, t1605.s_name, t1605.p_partkey) AS t1619",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
1,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-07' and l_shipdate > date '1995-03-07' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-07') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-07') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
2,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-01-01' AND o_orderdate < (DATE '1994-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
3,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t940.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t940.n_name0 AS CHAR(7)) = 'ROMANIA' THEN t940.l_extendedprice * (1 - t940.l_discount) ELSE 0 END) / SUM(t940.l_extendedprice * (1 - t940.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE POLISHED STEEL') AS t934, supplier AS supplier102, lineitem AS lineitem102 WHERE t934.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t935, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t936 WHERE t935.l_orderkey = t936.o_orderkey) AS t937, customer AS customer102 WHERE t937.o_custkey = customer102.c_custkey) AS t938, nation AS nation205 WHERE t938.c_nationkey = nation205.n_nationkey) AS t939, nation AS nation206 WHERE t939.s_nationkey = nation206.n_nationkey) AS t940, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t941 WHERE t940.n_regionkey = t941.r_regionkey GROUP BY EXTRACT(YEAR FROM t940.o_orderdate) ORDER BY EXTRACT(YEAR FROM t940.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
4,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%olive%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation100.n_name AS nation, EXTRACT(YEAR FROM orders100.o_orderdate) AS o_year, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount) - partsupp100.ps_supplycost * lineitem100.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%olive%') AS t591 CROSS JOIN supplier AS supplier100 INNER JOIN lineitem AS lineitem100 ON supplier100.s_suppkey = lineitem100.l_suppkey AND t591.p_partkey = lineitem100.l_partkey INNER JOIN partsupp AS partsupp100 ON lineitem100.l_suppkey = partsupp100.ps_suppkey AND lineitem100.l_partkey = partsupp100.ps_partkey INNER JOIN orders AS orders100 ON lineitem100.l_orderkey = orders100.o_orderkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey GROUP BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) ORDER BY nation100.n_name, EXTRACT(YEAR FROM orders100.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
5,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-10-01' and o_orderdate < date '1993-10-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT t742.c_custkey, t742.c_name, SUM(t742.l_extendedprice * (1 - t742.l_discount)) AS revenue, t742.c_acctbal, nation100.n_name, t742.c_address, t742.c_phone, t742.c_comment FROM (SELECT * FROM (SELECT * FROM customer AS customer100, (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-10-01' AND o_orderdate < (DATE '1993-10-01' + INTERVAL '3' MONTH)) AS t739 WHERE customer100.c_custkey = t739.o_custkey) AS t740, (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t741 WHERE t741.l_orderkey = t740.o_orderkey) AS t742, nation AS nation100 WHERE t742.c_nationkey = nation100.n_nationkey GROUP BY t742.c_custkey, t742.c_name, t742.c_acctbal, t742.c_phone, nation100.n_name, t742.c_address, t742.c_comment ORDER BY SUM(t742.l_extendedprice * (1 - t742.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
6,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 313 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT t95.c_name, t95.c_custkey, t95.o_orderkey, t95.o_orderdate, t95.o_totalprice, t95.f8 FROM (SELECT t93.c_custkey, t93.c_name, t93.o_orderkey, t93.o_totalprice, t93.o_orderdate, t93.f8 * t94.EXPR5 AS f8 FROM (SELECT t91.c_custkey, t91.c_name, t92.o_orderkey, t92.o_totalprice, t92.o_orderdate, t91.f2 * t92.f4 AS f8 FROM (SELECT c_custkey, c_name, COUNT(*) AS f2 FROM customer GROUP BY c_custkey, c_name) AS t91 INNER JOIN (SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, COUNT(*) AS f4 FROM orders GROUP BY o_orderkey, o_custkey, o_totalprice, o_orderdate) AS t92 ON t91.c_custkey = t92.o_custkey) AS t93 INNER JOIN (SELECT l_orderkey, SUM(l_quantity) AS EXPR5 FROM lineitem GROUP BY l_orderkey) AS t94 ON t93.o_orderkey = t94.l_orderkey) AS t95 INNER JOIN (SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 313) AS t98 ON t95.o_orderkey = t98.l_orderkey ORDER BY t95.o_totalprice DESC, t95.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalAggregate', 'LogicalProject', 'LogicalTableScan']]]]]]]]"
7,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'MOROCCO' group by s_name order by numwait desc, s_name;",,['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
8,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '24', '36', '34', '32', '42', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '24', '36', '34', '32', '42', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '33' OR (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '32' OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '26')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
9,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%NICKEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
10,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-01' and l_shipdate > date '1995-03-01' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t793.l_orderkey, SUM(t793.l_extendedprice * (1 - t793.l_discount)) AS revenue, t792.o_orderdate, t792.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t790, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-01') AS t791 WHERE t790.c_custkey = t791.o_custkey) AS t792, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-01') AS t793 WHERE t793.l_orderkey = t792.o_orderkey GROUP BY t793.l_orderkey, t792.o_orderdate, t792.o_shippriority ORDER BY SUM(t793.l_extendedprice * (1 - t793.l_discount)) DESC, t792.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
11,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-02-01' and o_orderdate < date '1993-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t0.o_orderpriority, COALESCE(SUM(t0.order_count * t3.order_count), 0) AS order_count FROM (SELECT o_orderkey, o_orderpriority, COUNT(*) AS order_count FROM orders WHERE o_orderdate >= DATE '1993-02-01' AND o_orderdate < (DATE '1993-02-01' + INTERVAL '3' MONTH) GROUP BY o_orderkey, o_orderpriority) AS t0 INNER JOIN (SELECT l_orderkey, COUNT(*) AS order_count FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t3 ON t0.o_orderkey = t3.l_orderkey GROUP BY t0.o_orderpriority ORDER BY t0.o_orderpriority;",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
12,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t188.o_orderdate) AS o_year, SUM(CASE WHEN CAST(nation44.n_name AS CHAR(4)) = 'PERU' THEN lineitem21.l_extendedprice * (1 - lineitem21.l_discount) ELSE 0 END) / SUM(lineitem21.l_extendedprice * (1 - lineitem21.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED NICKEL') AS t187 CROSS JOIN supplier AS supplier21 INNER JOIN lineitem AS lineitem21 ON t187.p_partkey = lineitem21.l_partkey AND supplier21.s_suppkey = lineitem21.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t188 ON lineitem21.l_orderkey = t188.o_orderkey INNER JOIN customer AS customer21 ON t188.o_custkey = customer21.c_custkey INNER JOIN nation AS nation43 ON customer21.c_nationkey = nation43.n_nationkey INNER JOIN nation AS nation44 ON supplier21.s_nationkey = nation44.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t189 ON nation43.n_regionkey = t189.r_regionkey GROUP BY EXTRACT(YEAR FROM t188.o_orderdate) ORDER BY EXTRACT(YEAR FROM t188.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
13,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%antique%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation99.n_name AS nation, EXTRACT(YEAR FROM orders99.o_orderdate) AS o_year, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount) - partsupp99.ps_supplycost * lineitem99.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%antique%') AS t583 CROSS JOIN supplier AS supplier99 INNER JOIN lineitem AS lineitem99 ON supplier99.s_suppkey = lineitem99.l_suppkey AND t583.p_partkey = lineitem99.l_partkey INNER JOIN partsupp AS partsupp99 ON lineitem99.l_suppkey = partsupp99.ps_suppkey AND lineitem99.l_partkey = partsupp99.ps_partkey INNER JOIN orders AS orders99 ON lineitem99.l_orderkey = orders99.o_orderkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey GROUP BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) ORDER BY nation99.n_name, EXTRACT(YEAR FROM orders99.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
14,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 312 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT t157.c_name, t157.c_custkey, t157.o_orderkey, t157.o_orderdate, t157.o_totalprice, t157.f8 FROM (SELECT t155.c_custkey, t155.c_name, t155.o_orderkey, t155.o_totalprice, t155.o_orderdate, t155.f8 * t156.EXPR5 AS f8 FROM (SELECT t153.c_custkey, t153.c_name, t154.o_orderkey, t154.o_totalprice, t154.o_orderdate, t153.f2 * t154.f4 AS f8 FROM (SELECT c_custkey, c_name, COUNT(*) AS f2 FROM customer GROUP BY c_custkey, c_name) AS t153 INNER JOIN (SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, COUNT(*) AS f4 FROM orders GROUP BY o_orderkey, o_custkey, o_totalprice, o_orderdate) AS t154 ON t153.c_custkey = t154.o_custkey) AS t155 INNER JOIN (SELECT l_orderkey, SUM(l_quantity) AS EXPR5 FROM lineitem GROUP BY l_orderkey) AS t156 ON t155.o_orderkey = t156.l_orderkey) AS t157 INNER JOIN (SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 312) AS t160 ON t157.o_orderkey = t160.l_orderkey ORDER BY t157.o_totalprice DESC, t157.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalAggregate', 'LogicalProject', 'LogicalTableScan']]]]]]]]"
15,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'JAPAN' group by s_name order by numwait desc, s_name;","SELECT t784.s_name, COUNT(*) AS numwait FROM (SELECT supplier191.s_suppkey, supplier191.s_name, supplier191.s_address, supplier191.s_nationkey, supplier191.s_phone, supplier191.s_acctbal, supplier191.s_comment, t779.l_orderkey, t779.l_partkey, t779.l_suppkey, t779.l_linenumber, t779.l_quantity, t779.l_extendedprice, t779.l_discount, t779.l_tax, t779.l_returnflag, t779.l_linestatus, t779.l_shipdate, t779.l_commitdate, t779.l_receiptdate, t779.l_shipinstruct, t779.l_shipmode, t779.l_comment, t780.o_orderkey, t780.o_custkey, t780.o_orderstatus, t780.o_totalprice, t780.o_orderdate, t780.o_orderpriority, t780.o_clerk, t780.o_shippriority, t780.o_comment, t781.n_nationkey, t781.n_name, t781.n_regionkey, t781.n_comment, CAST(t783.f0 AS BOOLEAN) AS f0 FROM supplier AS supplier191 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t779 ON supplier191.s_suppkey = t779.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t780 ON t779.l_orderkey = t780.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'JAPAN') AS t781 ON supplier191.s_nationkey = t781.n_nationkey INNER JOIN (SELECT t782.l_orderkey AS l_orderkey0, t782.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem336 INNER JOIN (SELECT lineitem337.l_orderkey, lineitem337.l_suppkey FROM supplier AS supplier192, lineitem AS lineitem337, orders AS orders192, nation AS nation192) AS t782 ON lineitem336.l_orderkey = t782.l_orderkey AND lineitem336.l_suppkey <> t782.l_suppkey) AS t783 ON t779.l_orderkey = t783.l_orderkey0 AND t779.l_suppkey = t783.l_suppkey0) AS t784 LEFT JOIN (SELECT t791.l_orderkey AS l_orderkey0, t791.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t785 INNER JOIN (SELECT t786.l_orderkey, t786.l_suppkey FROM supplier AS supplier193 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t786 ON supplier193.s_suppkey = t786.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t787 ON t786.l_orderkey = t787.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'JAPAN') AS t788 ON supplier193.s_nationkey = t788.n_nationkey INNER JOIN (SELECT t789.l_orderkey AS l_orderkey0, t789.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem340 INNER JOIN (SELECT lineitem341.l_orderkey, lineitem341.l_suppkey FROM supplier AS supplier194, lineitem AS lineitem341, orders AS orders194, nation AS nation194) AS t789 ON lineitem340.l_orderkey = t789.l_orderkey AND lineitem340.l_suppkey <> t789.l_suppkey) AS t790 ON t786.l_orderkey = t790.l_orderkey0 AND t786.l_suppkey = t790.l_suppkey0) AS t791 ON t785.l_orderkey = t791.l_orderkey AND t785.l_suppkey <> t791.l_suppkey) AS t792 ON t784.l_orderkey = t792.l_orderkey0 AND t784.l_suppkey = t792.l_suppkey0 WHERE t792.f0 IS NULL GROUP BY t784.s_name ORDER BY COUNT(*) DESC, t784.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
16,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '34', '21', '31', '41', '44', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '34', '21', '31', '41', '44', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR (SUBSTR(c_phone FROM 1 FOR 2) = '34' OR SUBSTR(c_phone FROM 1 FOR 2) = '21') OR (SUBSTR(c_phone FROM 1 FOR 2) = '31' OR SUBSTR(c_phone FROM 1 FOR 2) = '41' OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '35')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
17,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 37 AND p_type LIKE '%STEEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'MIDDLE EAST' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
18,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-31' and l_shipdate > date '1995-03-31' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-31') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-31') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
19,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation103.n_name, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) AS revenue FROM customer AS customer103 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-01-01' AND o_orderdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t765 ON customer103.c_custkey = t765.o_custkey INNER JOIN lineitem AS lineitem103 ON t765.o_orderkey = lineitem103.l_orderkey INNER JOIN supplier AS supplier103 ON lineitem103.l_suppkey = supplier103.s_suppkey AND customer103.c_nationkey = supplier103.s_nationkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t766 ON nation103.n_regionkey = t766.r_regionkey GROUP BY nation103.n_name ORDER BY SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
20,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t987.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t987.n_name0 AS CHAR(5)) = 'JAPAN' THEN t987.l_extendedprice * (1 - t987.l_discount) ELSE 0 END) / SUM(t987.l_extendedprice * (1 - t987.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED COPPER') AS t981, supplier AS supplier101, lineitem AS lineitem101 WHERE t981.p_partkey = lineitem101.l_partkey AND supplier101.s_suppkey = lineitem101.l_suppkey) AS t982, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t983 WHERE t982.l_orderkey = t983.o_orderkey) AS t984, customer AS customer101 WHERE t984.o_custkey = customer101.c_custkey) AS t985, nation AS nation203 WHERE t985.c_nationkey = nation203.n_nationkey) AS t986, nation AS nation204 WHERE t986.s_nationkey = nation204.n_nationkey) AS t987, (SELECT * FROM region WHERE r_name = 'ASIA') AS t988 WHERE t987.n_regionkey = t988.r_regionkey GROUP BY EXTRACT(YEAR FROM t987.o_orderdate) ORDER BY EXTRACT(YEAR FROM t987.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
21,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'CANADA' group by s_name order by numwait desc, s_name;",,['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
22,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '22', '43', '26', '42', '27', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '22', '43', '26', '42', '27', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '23'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR (SUBSTR(c_phone FROM 1 FOR 2) = '22' OR SUBSTR(c_phone FROM 1 FOR 2) = '43') OR (SUBSTR(c_phone FROM 1 FOR 2) = '26' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '27' OR SUBSTR(c_phone FROM 1 FOR 2) = '23')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
23,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t1657.s_acctbal, t1657.s_name, t1657.n_name, t1657.p_partkey, t1657.p_mfgr, t1657.s_address, t1657.s_phone, t1657.s_comment FROM (SELECT t1643.p_partkey, t1643.p_name, t1643.p_mfgr, t1643.p_brand, t1643.p_type, t1643.p_size, t1643.p_container, t1643.p_retailprice, t1643.p_comment, t1643.s_suppkey, t1643.s_name, t1643.s_address, t1643.s_nationkey, t1643.s_phone, t1643.s_acctbal, t1643.s_comment, t1643.ps_partkey, t1643.ps_suppkey, t1643.ps_availqty, t1643.ps_supplycost, t1643.ps_comment, t1643.n_nationkey, t1643.n_name, t1643.n_regionkey, t1643.n_comment, t1643.r_regionkey, t1643.r_name, t1643.r_comment, CAST(t1654.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t1654.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 50 AND p_type LIKE '%NICKEL') AS t1639, supplier AS supplier207, partsupp AS partsupp207 WHERE t1639.p_partkey = partsupp207.ps_partkey AND supplier207.s_suppkey = partsupp207.ps_suppkey) AS t1640, nation AS nation207 WHERE t1640.s_nationkey = nation207.n_nationkey) AS t1641, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1642 WHERE t1641.n_regionkey = t1642.r_regionkey) AS t1643, (SELECT t1650.ps_partkey, MIN(t1650.EXPR0) AS EXPR0 FROM (SELECT t1647.ps_partkey, t1648.n_regionkey, MIN(t1647.EXPR0) AS EXPR0 FROM (SELECT t1644.ps_partkey, t1645.s_nationkey, MIN(t1644.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t1644, (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t1645 WHERE t1645.s_suppkey = t1644.ps_suppkey GROUP BY t1644.ps_partkey, t1645.s_nationkey) AS t1647, (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t1648 WHERE t1647.s_nationkey = t1648.n_nationkey GROUP BY t1647.ps_partkey, t1648.n_regionkey) AS t1650, (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t1652 WHERE t1650.n_regionkey = t1652.r_regionkey GROUP BY t1650.ps_partkey) AS t1654 WHERE t1643.p_partkey = t1654.ps_partkey AND t1643.ps_supplycost = t1654.EXPR0 ORDER BY t1643.s_acctbal DESC, t1643.n_name, t1643.s_name, t1643.p_partkey) AS t1657",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
24,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation103.n_name, SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) AS revenue FROM customer AS customer103 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-01-01' AND o_orderdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t765 ON customer103.c_custkey = t765.o_custkey INNER JOIN lineitem AS lineitem103 ON t765.o_orderkey = lineitem103.l_orderkey INNER JOIN supplier AS supplier103 ON lineitem103.l_suppkey = supplier103.s_suppkey AND customer103.c_nationkey = supplier103.s_nationkey INNER JOIN nation AS nation103 ON supplier103.s_nationkey = nation103.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t766 ON nation103.n_regionkey = t766.r_regionkey GROUP BY nation103.n_name ORDER BY SUM(lineitem103.l_extendedprice * (1 - lineitem103.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
25,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t994.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t994.n_name0 AS CHAR(6)) = 'FRANCE' THEN t994.l_extendedprice * (1 - t994.l_discount) ELSE 0 END) / SUM(t994.l_extendedprice * (1 - t994.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY ANODIZED STEEL') AS t988, supplier AS supplier102, lineitem AS lineitem102 WHERE t988.p_partkey = lineitem102.l_partkey AND supplier102.s_suppkey = lineitem102.l_suppkey) AS t989, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t990 WHERE t989.l_orderkey = t990.o_orderkey) AS t991, customer AS customer102 WHERE t991.o_custkey = customer102.c_custkey) AS t992, nation AS nation205 WHERE t992.c_nationkey = nation205.n_nationkey) AS t993, nation AS nation206 WHERE t993.s_nationkey = nation206.n_nationkey) AS t994, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t995 WHERE t994.n_regionkey = t995.r_regionkey GROUP BY EXTRACT(YEAR FROM t994.o_orderdate) ORDER BY EXTRACT(YEAR FROM t994.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
26,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'KENYA' group by s_name order by numwait desc, s_name;","SELECT t2093.s_name, COUNT(*) AS numwait FROM (SELECT supplier403.s_suppkey, supplier403.s_name, supplier403.s_address, supplier403.s_nationkey, supplier403.s_phone, supplier403.s_acctbal, supplier403.s_comment, t2088.l_orderkey, t2088.l_partkey, t2088.l_suppkey, t2088.l_linenumber, t2088.l_quantity, t2088.l_extendedprice, t2088.l_discount, t2088.l_tax, t2088.l_returnflag, t2088.l_linestatus, t2088.l_shipdate, t2088.l_commitdate, t2088.l_receiptdate, t2088.l_shipinstruct, t2088.l_shipmode, t2088.l_comment, t2089.o_orderkey, t2089.o_custkey, t2089.o_orderstatus, t2089.o_totalprice, t2089.o_orderdate, t2089.o_orderpriority, t2089.o_clerk, t2089.o_shippriority, t2089.o_comment, t2090.n_nationkey, t2090.n_name, t2090.n_regionkey, t2090.n_comment, CAST(t2092.f0 AS BOOLEAN) AS f0 FROM supplier AS supplier403 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2088 ON supplier403.s_suppkey = t2088.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2089 ON t2088.l_orderkey = t2089.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'KENYA') AS t2090 ON supplier403.s_nationkey = t2090.n_nationkey INNER JOIN (SELECT t2091.l_orderkey AS l_orderkey0, t2091.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem707 INNER JOIN (SELECT lineitem708.l_orderkey, lineitem708.l_suppkey FROM supplier AS supplier404, lineitem AS lineitem708, orders AS orders404, nation AS nation404) AS t2091 ON lineitem707.l_orderkey = t2091.l_orderkey AND lineitem707.l_suppkey <> t2091.l_suppkey) AS t2092 ON t2088.l_orderkey = t2092.l_orderkey0 AND t2088.l_suppkey = t2092.l_suppkey0) AS t2093 LEFT JOIN (SELECT t2100.l_orderkey AS l_orderkey0, t2100.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2094 INNER JOIN (SELECT t2095.l_orderkey, t2095.l_suppkey FROM supplier AS supplier405 INNER JOIN (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t2095 ON supplier405.s_suppkey = t2095.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderstatus = 'F') AS t2096 ON t2095.l_orderkey = t2096.o_orderkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'KENYA') AS t2097 ON supplier405.s_nationkey = t2097.n_nationkey INNER JOIN (SELECT t2098.l_orderkey AS l_orderkey0, t2098.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem711 INNER JOIN (SELECT lineitem712.l_orderkey, lineitem712.l_suppkey FROM supplier AS supplier406, lineitem AS lineitem712, orders AS orders406, nation AS nation406) AS t2098 ON lineitem711.l_orderkey = t2098.l_orderkey AND lineitem711.l_suppkey <> t2098.l_suppkey) AS t2099 ON t2095.l_orderkey = t2099.l_orderkey0 AND t2095.l_suppkey = t2099.l_suppkey0) AS t2100 ON t2094.l_orderkey = t2100.l_orderkey AND t2094.l_suppkey <> t2100.l_suppkey) AS t2101 ON t2093.l_orderkey = t2101.l_orderkey0 AND t2093.l_suppkey = t2101.l_suppkey0 WHERE t2101.f0 IS NULL GROUP BY t2093.s_name ORDER BY COUNT(*) DESC, t2093.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
27,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '29', '25', '42', '36', '32', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '29', '25', '42', '36', '32', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '24' OR (SUBSTR(c_phone FROM 1 FOR 2) = '29' OR SUBSTR(c_phone FROM 1 FOR 2) = '25') OR (SUBSTR(c_phone FROM 1 FOR 2) = '42' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '32' OR SUBSTR(c_phone FROM 1 FOR 2) = '33')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
28,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t328.s_acctbal, t328.s_name, t328.n_name, t328.p_partkey, t328.p_mfgr, t328.s_address, t328.s_phone, t328.s_comment FROM (SELECT t317.p_partkey, t317.p_name, t317.p_mfgr, t317.p_brand, t317.p_type, t317.p_size, t317.p_container, t317.p_retailprice, t317.p_comment, supplier43.s_suppkey, supplier43.s_name, supplier43.s_address, supplier43.s_nationkey, supplier43.s_phone, supplier43.s_acctbal, supplier43.s_comment, partsupp43.ps_partkey, partsupp43.ps_suppkey, partsupp43.ps_availqty, partsupp43.ps_supplycost, partsupp43.ps_comment, nation43.n_nationkey, nation43.n_name, nation43.n_regionkey, nation43.n_comment, t318.r_regionkey, t318.r_name, t318.r_comment, CAST(t326.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t326.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%NICKEL') AS t317 CROSS JOIN supplier AS supplier43 INNER JOIN partsupp AS partsupp43 ON t317.p_partkey = partsupp43.ps_partkey AND supplier43.s_suppkey = partsupp43.ps_suppkey INNER JOIN nation AS nation43 ON supplier43.s_nationkey = nation43.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t318 ON nation43.n_regionkey = t318.r_regionkey INNER JOIN (SELECT t323.ps_partkey, MIN(t323.EXPR0) AS EXPR0 FROM (SELECT t321.ps_partkey, t322.n_regionkey, MIN(t321.EXPR0) AS EXPR0 FROM (SELECT t319.ps_partkey, t320.s_nationkey, MIN(t319.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t319 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t320 ON t319.ps_suppkey = t320.s_suppkey GROUP BY t319.ps_partkey, t320.s_nationkey) AS t321 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t322 ON t321.s_nationkey = t322.n_nationkey GROUP BY t321.ps_partkey, t322.n_regionkey) AS t323 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'AFRICA' GROUP BY r_regionkey) AS t325 ON t323.n_regionkey = t325.r_regionkey GROUP BY t323.ps_partkey) AS t326 ON t317.p_partkey = t326.ps_partkey AND partsupp43.ps_supplycost = t326.EXPR0 ORDER BY supplier43.s_acctbal DESC, nation43.n_name, supplier43.s_name, t317.p_partkey) AS t328",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
29,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-05' and l_shipdate > date '1995-03-05' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t807.l_orderkey, SUM(t807.l_extendedprice * (1 - t807.l_discount)) AS revenue, t806.o_orderdate, t806.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t804, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-05') AS t805 WHERE t804.c_custkey = t805.o_custkey) AS t806, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-05') AS t807 WHERE t807.l_orderkey = t806.o_orderkey GROUP BY t807.l_orderkey, t806.o_orderdate, t806.o_shippriority ORDER BY SUM(t807.l_extendedprice * (1 - t807.l_discount)) DESC, t806.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
30,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-09-01' and o_orderdate < date '1993-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t8.o_orderpriority, COALESCE(SUM(t8.order_count * t10.order_count), 0) AS order_count FROM (SELECT o_orderkey, o_orderpriority, COUNT(*) AS order_count FROM orders WHERE o_orderdate >= DATE '1993-09-01' AND o_orderdate < (DATE '1993-09-01' + INTERVAL '3' MONTH) GROUP BY o_orderkey, o_orderpriority) AS t8 INNER JOIN (SELECT l_orderkey, COUNT(*) AS order_count FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t10 ON t8.o_orderkey = t10.l_orderkey GROUP BY t8.o_orderpriority ORDER BY t8.o_orderpriority",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]]]]]"
31,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation99.n_name, SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) AS revenue FROM customer AS customer99 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate < (DATE '1995-01-01' + INTERVAL '1' YEAR)) AS t725 ON customer99.c_custkey = t725.o_custkey INNER JOIN lineitem AS lineitem99 ON t725.o_orderkey = lineitem99.l_orderkey INNER JOIN supplier AS supplier99 ON lineitem99.l_suppkey = supplier99.s_suppkey AND customer99.c_nationkey = supplier99.s_nationkey INNER JOIN nation AS nation99 ON supplier99.s_nationkey = nation99.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t726 ON nation99.n_regionkey = t726.r_regionkey GROUP BY nation99.n_name ORDER BY SUM(lineitem99.l_extendedprice * (1 - lineitem99.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
32,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation207.n_name AS supp_nation, nation208.n_name AS cust_nation, EXTRACT(YEAR FROM t665.l_shipdate) AS l_year, SUM(t665.l_extendedprice * (1 - t665.l_discount)) AS revenue FROM supplier AS supplier103 INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t665 ON supplier103.s_suppkey = t665.l_suppkey INNER JOIN orders AS orders103 ON t665.l_orderkey = orders103.o_orderkey INNER JOIN customer AS customer103 ON orders103.o_custkey = customer103.c_custkey INNER JOIN nation AS nation207 ON supplier103.s_nationkey = nation207.n_nationkey INNER JOIN nation AS nation208 ON customer103.c_nationkey = nation208.n_nationkey AND (nation207.n_name = 'SAUDI ARABIA' AND nation208.n_name = 'ALGERIA' OR nation207.n_name = 'ALGERIA' AND nation208.n_name = 'SAUDI ARABIA') GROUP BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate) ORDER BY nation207.n_name, nation208.n_name, EXTRACT(YEAR FROM t665.l_shipdate)",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
33,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(7)) = 'ALGERIA' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
34,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 315 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT t866.c_name, t866.c_custkey, t866.o_orderkey, t866.o_orderdate, t866.o_totalprice, t866.f8 FROM (SELECT t864.c_custkey, t864.c_name, t864.o_orderkey, t864.o_totalprice, t864.o_orderdate, t864.f8 * t865.EXPR5 AS f8 FROM (SELECT t862.c_custkey, t862.c_name, t863.o_orderkey, t863.o_totalprice, t863.o_orderdate, t862.f2 * t863.f4 AS f8 FROM (SELECT c_custkey, c_name, COUNT(*) AS f2 FROM customer GROUP BY c_custkey, c_name) AS t862 INNER JOIN (SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, COUNT(*) AS f4 FROM orders GROUP BY o_orderkey, o_custkey, o_totalprice, o_orderdate) AS t863 ON t862.c_custkey = t863.o_custkey) AS t864 INNER JOIN (SELECT l_orderkey, SUM(l_quantity) AS EXPR5 FROM lineitem GROUP BY l_orderkey) AS t865 ON t864.o_orderkey = t865.l_orderkey) AS t866 INNER JOIN (SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 315) AS t869 ON t866.o_orderkey = t869.l_orderkey ORDER BY t866.o_totalprice DESC, t866.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalAggregate', 'LogicalProject', 'LogicalTableScan']]]]]]]]"
35,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '40', '36', '30', '42', '20', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '40', '36', '30', '42', '20', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '43' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '36') OR (SUBSTR(c_phone FROM 1 FOR 2) = '30' OR SUBSTR(c_phone FROM 1 FOR 2) = '42' OR (SUBSTR(c_phone FROM 1 FOR 2) = '20' OR SUBSTR(c_phone FROM 1 FOR 2) = '34')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
36,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t315.s_acctbal, t315.s_name, t315.n_name, t315.p_partkey, t315.p_mfgr, t315.s_address, t315.s_phone, t315.s_comment FROM (SELECT t304.p_partkey, t304.p_name, t304.p_mfgr, t304.p_brand, t304.p_type, t304.p_size, t304.p_container, t304.p_retailprice, t304.p_comment, supplier41.s_suppkey, supplier41.s_name, supplier41.s_address, supplier41.s_nationkey, supplier41.s_phone, supplier41.s_acctbal, supplier41.s_comment, partsupp41.ps_partkey, partsupp41.ps_suppkey, partsupp41.ps_availqty, partsupp41.ps_supplycost, partsupp41.ps_comment, nation41.n_nationkey, nation41.n_name, nation41.n_regionkey, nation41.n_comment, t305.r_regionkey, t305.r_name, t305.r_comment, CAST(t313.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t313.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%STEEL') AS t304 CROSS JOIN supplier AS supplier41 INNER JOIN partsupp AS partsupp41 ON t304.p_partkey = partsupp41.ps_partkey AND supplier41.s_suppkey = partsupp41.ps_suppkey INNER JOIN nation AS nation41 ON supplier41.s_nationkey = nation41.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t305 ON nation41.n_regionkey = t305.r_regionkey INNER JOIN (SELECT t310.ps_partkey, MIN(t310.EXPR0) AS EXPR0 FROM (SELECT t308.ps_partkey, t309.n_regionkey, MIN(t308.EXPR0) AS EXPR0 FROM (SELECT t306.ps_partkey, t307.s_nationkey, MIN(t306.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t306 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t307 ON t306.ps_suppkey = t307.s_suppkey GROUP BY t306.ps_partkey, t307.s_nationkey) AS t308 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t309 ON t308.s_nationkey = t309.n_nationkey GROUP BY t308.ps_partkey, t309.n_regionkey) AS t310 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE' GROUP BY r_regionkey) AS t312 ON t310.n_regionkey = t312.r_regionkey GROUP BY t310.ps_partkey) AS t313 ON t304.p_partkey = t313.ps_partkey AND partsupp41.ps_supplycost = t313.EXPR0 ORDER BY supplier41.s_acctbal DESC, nation41.n_name, supplier41.s_name, t304.p_partkey) AS t315",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
37,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-21' and l_shipdate > date '1995-03-21' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-21') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-21') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate;",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
38,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation100.n_name, SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) AS revenue FROM customer AS customer100 INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-01-01' AND o_orderdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t735 ON customer100.c_custkey = t735.o_custkey INNER JOIN lineitem AS lineitem100 ON t735.o_orderkey = lineitem100.l_orderkey INNER JOIN supplier AS supplier100 ON lineitem100.l_suppkey = supplier100.s_suppkey AND customer100.c_nationkey = supplier100.s_nationkey INNER JOIN nation AS nation100 ON supplier100.s_nationkey = nation100.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t736 ON nation100.n_regionkey = t736.r_regionkey GROUP BY nation100.n_name ORDER BY SUM(lineitem100.l_extendedprice * (1 - lineitem100.l_discount)) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
39,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'JAPAN' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED COPPER') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'ASIA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate);",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
40,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%rose%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation102.n_name AS nation, EXTRACT(YEAR FROM orders102.o_orderdate) AS o_year, SUM(lineitem102.l_extendedprice * (1 - lineitem102.l_discount) - partsupp102.ps_supplycost * lineitem102.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%rose%') AS t607 CROSS JOIN supplier AS supplier102 INNER JOIN lineitem AS lineitem102 ON supplier102.s_suppkey = lineitem102.l_suppkey AND t607.p_partkey = lineitem102.l_partkey INNER JOIN partsupp AS partsupp102 ON lineitem102.l_suppkey = partsupp102.ps_suppkey AND lineitem102.l_partkey = partsupp102.ps_partkey INNER JOIN orders AS orders102 ON lineitem102.l_orderkey = orders102.o_orderkey INNER JOIN nation AS nation102 ON supplier102.s_nationkey = nation102.n_nationkey GROUP BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) ORDER BY nation102.n_name, EXTRACT(YEAR FROM orders102.o_orderdate) DESC",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]"
41,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 314 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT t157.c_name, t157.c_custkey, t157.o_orderkey, t157.o_orderdate, t157.o_totalprice, t157.f8 FROM (SELECT t155.c_custkey, t155.c_name, t155.o_orderkey, t155.o_totalprice, t155.o_orderdate, t155.f8 * t156.EXPR5 AS f8 FROM (SELECT t153.c_custkey, t153.c_name, t154.o_orderkey, t154.o_totalprice, t154.o_orderdate, t153.f2 * t154.f4 AS f8 FROM (SELECT c_custkey, c_name, COUNT(*) AS f2 FROM customer GROUP BY c_custkey, c_name) AS t153 INNER JOIN (SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, COUNT(*) AS f4 FROM orders GROUP BY o_orderkey, o_custkey, o_totalprice, o_orderdate) AS t154 ON t153.c_custkey = t154.o_custkey) AS t155 INNER JOIN (SELECT l_orderkey, SUM(l_quantity) AS EXPR5 FROM lineitem GROUP BY l_orderkey) AS t156 ON t155.o_orderkey = t156.l_orderkey) AS t157 INNER JOIN (SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 314) AS t160 ON t157.o_orderkey = t160.l_orderkey ORDER BY t157.o_totalprice DESC, t157.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalProject', ['LogicalFilter', ['LogicalAggregate', 'LogicalProject', 'LogicalTableScan']]]]]]]]"
42,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'UNITED STATES' group by s_name order by numwait desc, s_name;","SELECT t2.s_name, COUNT(*) AS numwait FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey) AS t0 ON lineitem.l_orderkey = t0.l_orderkey0 AND lineitem.l_suppkey = t0.l_suppkey0 WHERE supplier.s_suppkey = lineitem.l_suppkey AND (orders.o_orderkey = lineitem.l_orderkey AND orders.o_orderstatus = 'F') AND (lineitem.l_receiptdate > lineitem.l_commitdate AND supplier.s_nationkey = nation.n_nationkey AND (nation.n_name = 'UNITED STATES' AND t0.f0 IS NOT NULL))) AS t2 LEFT JOIN (SELECT t8.l_orderkey AS l_orderkey0, t8.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t3 INNER JOIN (SELECT lineitem3.l_orderkey, lineitem3.l_suppkey FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t4.l_orderkey AS l_orderkey0, t4.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2) AS t4 ON lineitem4.l_orderkey = t4.l_orderkey AND lineitem4.l_suppkey <> t4.l_suppkey) AS t5 ON lineitem3.l_orderkey = t5.l_orderkey0 AND lineitem3.l_suppkey = t5.l_suppkey0 WHERE supplier1.s_suppkey = lineitem3.l_suppkey AND (orders1.o_orderkey = lineitem3.l_orderkey AND orders1.o_orderstatus = 'F') AND (lineitem3.l_receiptdate > lineitem3.l_commitdate AND supplier1.s_nationkey = nation1.n_nationkey AND (nation1.n_name = 'UNITED STATES' AND t5.f0 IS NOT NULL))) AS t8 ON t3.l_orderkey = t8.l_orderkey AND t3.l_suppkey <> t8.l_suppkey) AS t9 ON t2.l_orderkey = t9.l_orderkey0 AND t2.l_suppkey = t9.l_suppkey0 WHERE t9.f0 IS NULL GROUP BY t2.s_name ORDER BY COUNT(*) DESC, t2.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
43,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '40', '39', '44', '36', '21', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '40', '39', '44', '36', '21', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM 1 FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '20'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM 1 FOR 2) = '37' OR (SUBSTR(c_phone FROM 1 FOR 2) = '40' OR SUBSTR(c_phone FROM 1 FOR 2) = '39') OR (SUBSTR(c_phone FROM 1 FOR 2) = '44' OR SUBSTR(c_phone FROM 1 FOR 2) = '36' OR (SUBSTR(c_phone FROM 1 FOR 2) = '21' OR SUBSTR(c_phone FROM 1 FOR 2) = '20')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, TRUE AS f0 FROM orders) AS t2 ON t.c_custkey = t2.o_custkey WHERE t2.f0 IS NULL GROUP BY SUBSTR(t.c_phone FROM 1 FOR 2) ORDER BY SUBSTR(t.c_phone FROM 1 FOR 2);",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalAggregate', ['LogicalProject', 'LogicalFilter', 'LogicalTableScan']]], ['LogicalProject', 'LogicalTableScan']]]]]]"
44,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t340.s_acctbal, t340.s_name, t340.n_name, t340.p_partkey, t340.p_mfgr, t340.s_address, t340.s_phone, t340.s_comment FROM (SELECT t329.p_partkey, t329.p_name, t329.p_mfgr, t329.p_brand, t329.p_type, t329.p_size, t329.p_container, t329.p_retailprice, t329.p_comment, supplier45.s_suppkey, supplier45.s_name, supplier45.s_address, supplier45.s_nationkey, supplier45.s_phone, supplier45.s_acctbal, supplier45.s_comment, partsupp45.ps_partkey, partsupp45.ps_suppkey, partsupp45.ps_availqty, partsupp45.ps_supplycost, partsupp45.ps_comment, nation45.n_nationkey, nation45.n_name, nation45.n_regionkey, nation45.n_comment, t330.r_regionkey, t330.r_name, t330.r_comment, CAST(t338.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t338.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%STEEL') AS t329 CROSS JOIN supplier AS supplier45 INNER JOIN partsupp AS partsupp45 ON t329.p_partkey = partsupp45.ps_partkey AND supplier45.s_suppkey = partsupp45.ps_suppkey INNER JOIN nation AS nation45 ON supplier45.s_nationkey = nation45.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t330 ON nation45.n_regionkey = t330.r_regionkey INNER JOIN (SELECT t335.ps_partkey, MIN(t335.EXPR0) AS EXPR0 FROM (SELECT t333.ps_partkey, t334.n_regionkey, MIN(t333.EXPR0) AS EXPR0 FROM (SELECT t331.ps_partkey, t332.s_nationkey, MIN(t331.EXPR0) AS EXPR0 FROM (SELECT ps_partkey, ps_suppkey, MIN(ps_supplycost) AS EXPR0 FROM partsupp GROUP BY ps_partkey, ps_suppkey) AS t331 INNER JOIN (SELECT s_suppkey, s_nationkey FROM supplier GROUP BY s_suppkey, s_nationkey) AS t332 ON t331.ps_suppkey = t332.s_suppkey GROUP BY t331.ps_partkey, t332.s_nationkey) AS t333 INNER JOIN (SELECT n_nationkey, n_regionkey FROM nation GROUP BY n_nationkey, n_regionkey) AS t334 ON t333.s_nationkey = t334.n_nationkey GROUP BY t333.ps_partkey, t334.n_regionkey) AS t335 INNER JOIN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA' GROUP BY r_regionkey) AS t337 ON t335.n_regionkey = t337.r_regionkey GROUP BY t335.ps_partkey) AS t338 ON t329.p_partkey = t338.ps_partkey AND partsupp45.ps_supplycost = t338.EXPR0 ORDER BY supplier45.s_acctbal DESC, nation45.n_name, supplier45.s_name, t329.p_partkey) AS t340",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']], ['LogicalAggregate', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalFilter', 'LogicalTableScan']]]]]]]]"
45,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t800.l_orderkey, SUM(t800.l_extendedprice * (1 - t800.l_discount)) AS revenue, t799.o_orderdate, t799.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t797, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-16') AS t798 WHERE t797.c_custkey = t798.o_custkey) AS t799, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-16') AS t800 WHERE t800.l_orderkey = t799.o_orderkey GROUP BY t800.l_orderkey, t799.o_orderdate, t799.o_shippriority ORDER BY SUM(t800.l_extendedprice * (1 - t800.l_discount)) DESC, t799.o_orderdate",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']]]]]]]"
46,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t1001.o_orderdate) AS o_year, SUM(CASE WHEN CAST(t1001.n_name0 AS CHAR(5)) = 'EGYPT' THEN t1001.l_extendedprice * (1 - t1001.l_discount) ELSE 0 END) / SUM(t1001.l_extendedprice * (1 - t1001.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED BRASS') AS t995, supplier AS supplier103, lineitem AS lineitem103 WHERE t995.p_partkey = lineitem103.l_partkey AND supplier103.s_suppkey = lineitem103.l_suppkey) AS t996, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t997 WHERE t996.l_orderkey = t997.o_orderkey) AS t998, customer AS customer103 WHERE t998.o_custkey = customer103.c_custkey) AS t999, nation AS nation207 WHERE t999.c_nationkey = nation207.n_nationkey) AS t1000, nation AS nation208 WHERE t1000.s_nationkey = nation208.n_nationkey) AS t1001, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1002 WHERE t1001.n_regionkey = t1002.r_regionkey GROUP BY EXTRACT(YEAR FROM t1001.o_orderdate) ORDER BY EXTRACT(YEAR FROM t1001.o_orderdate)",['Empty List'],"['LogicalSort', ['LogicalProject', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]"
47,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'IRAQ' group by s_name order by numwait desc, s_name;","SELECT t38.s_name, COUNT(*) AS numwait FROM (SELECT supplier7.s_suppkey, supplier7.s_name, supplier7.s_address, supplier7.s_nationkey, supplier7.s_phone, supplier7.s_acctbal, supplier7.s_comment, lineitem13.l_orderkey, lineitem13.l_partkey, lineitem13.l_suppkey, lineitem13.l_linenumber, lineitem13.l_quantity, lineitem13.l_extendedprice, lineitem13.l_discount, lineitem13.l_tax, lineitem13.l_returnflag, lineitem13.l_linestatus, lineitem13.l_shipdate, lineitem13.l_commitdate, lineitem13.l_receiptdate, lineitem13.l_shipinstruct, lineitem13.l_shipmode, lineitem13.l_comment, orders7.o_orderkey, orders7.o_custkey, orders7.o_orderstatus, orders7.o_totalprice, orders7.o_orderdate, orders7.o_orderpriority, orders7.o_clerk, orders7.o_shippriority, orders7.o_comment, nation7.n_nationkey, nation7.n_name, nation7.n_regionkey, nation7.n_comment, t36.f0 FROM supplier AS supplier7 CROSS JOIN lineitem AS lineitem13 CROSS JOIN orders AS orders7 CROSS JOIN nation AS nation7 LEFT JOIN (SELECT t35.l_orderkey AS l_orderkey0, t35.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem14 INNER JOIN (SELECT lineitem15.l_orderkey, lineitem15.l_suppkey FROM supplier AS supplier8, lineitem AS lineitem15, orders AS orders8, nation AS nation8) AS t35 ON lineitem14.l_orderkey = t35.l_orderkey AND lineitem14.l_suppkey <> t35.l_suppkey) AS t36 ON lineitem13.l_orderkey = t36.l_orderkey0 AND lineitem13.l_suppkey = t36.l_suppkey0 WHERE supplier7.s_suppkey = lineitem13.l_suppkey AND (orders7.o_orderkey = lineitem13.l_orderkey AND orders7.o_orderstatus = 'F') AND (lineitem13.l_receiptdate > lineitem13.l_commitdate AND supplier7.s_nationkey = nation7.n_nationkey AND (nation7.n_name = 'IRAQ' AND t36.f0 IS NOT NULL))) AS t38 LEFT JOIN (SELECT t44.l_orderkey AS l_orderkey0, t44.l_suppkey AS l_suppkey0, TRUE AS f0 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t39 INNER JOIN (SELECT lineitem17.l_orderkey, lineitem17.l_suppkey FROM supplier AS supplier9 CROSS JOIN lineitem AS lineitem17 CROSS JOIN orders AS orders9 CROSS JOIN nation AS nation9 LEFT JOIN (SELECT t40.l_orderkey AS l_orderkey0, t40.l_suppkey AS l_suppkey0, TRUE AS f0 FROM lineitem AS lineitem18 INNER JOIN (SELECT lineitem19.l_orderkey, lineitem19.l_suppkey FROM supplier AS supplier10, lineitem AS lineitem19, orders AS orders10, nation AS nation10) AS t40 ON lineitem18.l_orderkey = t40.l_orderkey AND lineitem18.l_suppkey <> t40.l_suppkey) AS t41 ON lineitem17.l_orderkey = t41.l_orderkey0 AND lineitem17.l_suppkey = t41.l_suppkey0 WHERE supplier9.s_suppkey = lineitem17.l_suppkey AND (orders9.o_orderkey = lineitem17.l_orderkey AND orders9.o_orderstatus = 'F') AND (lineitem17.l_receiptdate > lineitem17.l_commitdate AND supplier9.s_nationkey = nation9.n_nationkey AND (nation9.n_name = 'IRAQ' AND t41.f0 IS NOT NULL))) AS t44 ON t39.l_orderkey = t44.l_orderkey AND t39.l_suppkey <> t44.l_suppkey) AS t45 ON t38.l_orderkey = t45.l_orderkey0 AND t38.l_suppkey = t45.l_suppkey0 WHERE t45.f0 IS NULL GROUP BY t38.s_name ORDER BY COUNT(*) DESC, t38.s_name",['Empty List'],"['LogicalSort', ['LogicalAggregate', ['LogicalProject', ['LogicalFilter', ['LogicalJoin', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]], ['LogicalProject', ['LogicalJoin', ['LogicalFilter', 'LogicalTableScan'], ['LogicalProject', ['LogicalFilter', ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']], ['LogicalProject', ['LogicalJoin', ['LogicalTableScan'], ['LogicalProject', ['LogicalJoin', ['LogicalJoin', ['LogicalJoin', 'LogicalTableScan', 'LogicalTableScan'], ['LogicalTableScan']], ['LogicalTableScan']]]]]]]]]]]]]]]]"
